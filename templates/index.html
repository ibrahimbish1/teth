<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sensor Data</title>
    <script>
        // Function to send data to Flask app
        async function sendData() {
            // Gather data from the form
            const sensorId = document.getElementById("sensor_id").value;
            const temperature = document.getElementById("temperature").value;
            const humidity = document.getElementById("humidity").value;
            const timestamp = new Date().toISOString();

            // Create the data object
            const dataToSend = {
                sensor_id: sensorId,
                temperature: parseFloat(temperature),
                humidity: parseFloat(humidity),
                timestamp: timestamp
            };

            // Send data to Flask app (POST request)
            const response = await fetch('https://your-heroku-app-name.herokuapp.com/send_data', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(dataToSend)
            });

            const responseData = await response.json();

            // Show response in the result section
            const resultElement = document.getElementById("result");
            if (response.status === 200) {
                resultElement.innerHTML = "Data received successfully!";
            } else {
                resultElement.innerHTML = `Error: ${responseData.message}`;
            }
        }

        // Function to fetch and display data from the server
        async function getData() {
            const response = await fetch('https://your-heroku-app-name.herokuapp.com/get_data');
            const responseData = await response.json();
            const resultElement = document.getElementById("data");

            // Format and display the data
            if (response.status === 200) {
                const data = responseData.data.map(item => `
                    <p>Sensor ID: ${item.sensor_id}, Temperature: ${item.temperature}, Humidity: ${item.humidity}, Timestamp: ${item.timestamp}</p>
                `).join('');
                resultElement.innerHTML = data || "No data available.";
            } else {
                resultElement.innerHTML = `Error: ${responseData.message}`;
            }
        }
    </script>
</head>
<body>
    <h1>Sensor Data</h1>

    <!-- Form to send data -->
    <form onsubmit="event.preventDefault(); sendData();">
        <label for="sensor_id">Sensor ID:</label>
        <input type="text" id="sensor_id" required><br><br>

        <label for="temperature">Temperature:</label>
        <input type="number" id="temperature" step="0.1" required><br><br>

        <label for="humidity">Humidity:</label>
        <input type="number" id="humidity" step="0.1" required><br><br>

        <button type="submit">Send Data</button>
    </form>

    <!-- Result message -->
    <div id="result" style="margin-top: 20px;"></div>

    <hr>

    <!-- Display stored data -->
    <h2>Stored Data</h2>
    <button onclick="getData()">Fetch Data</button>
    <div id="data" style="margin-top: 20px;"></div>

</body>
</html>
